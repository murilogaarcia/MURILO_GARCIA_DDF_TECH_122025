# Queries Analíticas

Todas as queries abaixo são executadas diretamente no Metabase sobre o banco Gold (PostgreSQL via Neon).

---
Criação do DB PostgreeSQL das Camadas e das Views


## Um dos visuais desenvolvidos
## Top 5 Categorias por Receita Líquida

Arquivo: `sql/top5_categorias.sql`

```sql
SELECT
    p.category_name,
    SUM(f.net_revenue) AS total_liquido
FROM TB_PA37IS_GOLD_FACT_SALES f
JOIN TB_PA37IS_GOLD_DIM_PRODUCT p
    ON f.product_id = p.product_id
GROUP BY p.category_name
ORDER BY total_liquido DESC
LIMIT 5;
